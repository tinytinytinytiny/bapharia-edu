---
import { queryStoryblokGApi, getStoryblokImageDimensions } from "@utils";
import BaseLayout from "@layouts/BaseLayout.astro";
import PageTitle from "@components/PageTitle/PageTitle.astro";
import ArticleCard from "@components/Card/ArticleCard.astro";

const {
	ArticleItems: { items },
} = await queryStoryblokGApi({
	query: `
		query {
			ArticleItems(starts_with: "guides/", sort_by: "name:asc") {
				items {
					full_slug
					content {
						title
						summary
						cover_image {
							filename
						}
					}
				}
			}
		}
	`,
});
---

<BaseLayout title="Guides">
	<PageTitle title="Guides">
		<p>
			Here you can learn about the gameâ€™s systems, find helpful resources,
			and reference data that has been gathered.
		</p>
	</PageTitle>
	<div>
		<ul class="auto-grid" role="list">
			{
				items.map((guide) => (
					<li>
						<ArticleCard
							class="bs-full"
							innerClass="sm:bg-surface-0"
							title={guide.content.title}
							url={`/${guide.full_slug}`}
						>
							<p slot="summary">{guide.content.summary}</p>
							<img
								slot="img"
								src={`${guide.content.cover_image.filename}/m/`}
								alt={guide.content.cover_image.alt}
								width={
									getStoryblokImageDimensions(
										guide.content.cover_image.filename
									).width
								}
								height={
									getStoryblokImageDimensions(
										guide.content.cover_image.filename
									).height
								}
								loading="lazy"
								decoding="async"
							/>
						</ArticleCard>
					</li>
				))
			}
		</ul>
	</div>
</BaseLayout>
