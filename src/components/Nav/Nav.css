@layer base {
	:root {
		--nav-toggle-content-offset: calc(var(--button-height) + var(--space-s));
		--sidebar-width: calc(var(--space-2xl-rem) + var(--space-s-rem));
		--sidebar-submenu-width: var(--space-5xl-rem);
		--sidebar-content-offset: var(--sidebar-width);
	}

	.main-region {
		margin-top: var(--nav-toggle-content-offset);
	}

	@screen md {
		.main-region {
			margin-inline-start: var(--sidebar-content-offset);
			margin-top: 0;
			padding-inline-start: var(--space-2xs);
		}
	}

	@screen lg {
		.submenu-expanded {
			--sidebar-content-offset: calc(var(--sidebar-width) + var(--sidebar-submenu-width));
		}
	}
}

@layer components {
	.primary-nav {
		inset-inline: 0;
		position: fixed;
		top: 0;
		z-index: 10;
	}

	.primary-nav.open {
		background-color: var(--color-surface-2);
		height: 100vh;
		height: 100lvh;
		inset-inline: 0;
	}

	.primary-nav__inner {
		padding-block: var(--space-s);
	}

	.open > .primary-nav__inner {
		height: 100%;
		height: 100dvh;
		overflow-y: auto;
		overscroll-behavior: none;
	}

	.nav-toggle {
		@apply shadow-md;
		margin-inline: var(--space-s);
	}

	.primary-nav.open .nav-toggle {
		position: sticky;
		top: 0;
	}

	.nav-menu,
	.nav-submenu {
		--stack-space: var(--space-2xs);
	}

	.nav-menu {
		display: none;
		font-size: var(--text-1);
		margin-block-start: var(--space-m);
		padding-inline: var(--space-2xs);
		padding-bottom: calc(var(--space-s) + env(safe-area-inset-bottom));
	}

	[aria-expanded="true"] + .nav-menu {
		display: block;
	}

	.nav-item__link,
	.nav-submenu-item__link {
		border: 2px solid transparent;
		border-radius: var(--border-radius);
		cursor: pointer;
	}

	.nav-item__link {
		align-items: center;
		display: flex;
		gap: var(--space-xs);
		inline-size: 100%;
		padding-block: var(--space-2xs);
		padding-inline: var(--space-3xs);
	}

	.nav-item__link:hover,
	.nav-submenu-item__link:hover {
		background-color: var(--color-shade);
	}

	.nav-item__link:focus,
	.nav-submenu-item__link:focus {
		@apply focus-ring;
	}

	.primary-nav [aria-current="page"] {
		color: var(--color-text-strong);
		background-color: var(--color-accent-surface);
		font-weight: 700;
	}

	.nav-item__icon-container {
		display: inline-block;
	}

	.nav-item__icon-container svg {
		height: var(--space-l);
		width: var(--space-l);
		vertical-align: middle;
	}

	.nav-submenu {
		display: none;
		margin-block-start: var(--stack-space);
		padding-inline-start: calc(var(--space-l) + var(--space-2xs));
	}

	.nav-item__link.expanded + .nav-submenu,
	.nav-item__link.expanded + * > .nav-submenu {
		display: block;
	}

	.nav-submenu-item__link {
		display: block;
		padding: var(--space-2xs);
	}

	@screen md {

		.primary-nav,
		.primary-nav.open {
			height: 100vh;
			height: 100lvh;
			inset-inline-end: auto;
			top: 0;
		}

		.primary-nav__inner,
		.open > .primary-nav__inner {
			height: 100%;
			height: 100dvh;
			padding: 0;
		}

		.primary-nav.open {
			background-color: transparent;
		}

		.open > .primary-nav__inner {
			overflow: initial;
		}

		.nav-toggle {
			display: none;
		}

		.nav-menu {
			--stack-space: var(--space-3xs);
			display: block;
			font-size: var(--text-0);
			height: 100%;
			inline-size: var(--sidebar-width);
			margin-block-start: 0;
			overflow-y: auto;
			padding-block: var(--space-xs);
			padding-bottom: calc(var(--space-xs) + env(safe-area-inset-bottom));
		}

		.nav-item {
			font-size: var(--text--1);
			line-height: 1.25;
			text-align: center;
		}

		.nav-item__link {
			border: none;
			margin: auto;
			padding-inline: var(--space-2xs);
		}

		.nav-item__link:focus {
			outline: none;
		}

		.nav-item__link[aria-current] {
			background: transparent;
		}

		.nav-item__link,
		.nav-item__icon-container {
			align-items: center;
			display: flex;
			flex-flow: column nowrap;
			justify-content: center;
			gap: var(--space-3xs);
		}

		.nav-item__icon-container {
			border: 2px solid transparent;
			border-radius: var(--border-radius);
			box-sizing: content-box;
			padding-inline: var(--space-2xs);
		}

		.nav-item__link:hover .nav-item__icon-container {
			background-color: var(--color-shade);
		}

		.nav-item__link[aria-current="page"] .nav-item__icon-container {
			background-color: var(--color-accent-surface);
		}

		.nav-item__link:focus .nav-item__icon-container {
			@apply focus-ring;
		}

		.nav-submenu {
			background-color: var(--color-surface-2);
			height: 100vh;
			height: 100lvh;
			font-size: 1rem;
			inset-inline-start: var(--sidebar-width);
			inline-size: var(--sidebar-submenu-width);
			margin-block-start: 0;
			overflow-y: auto;
			overscroll-behavior: none;
			padding-block: var(--space-xs);
			padding-bottom: calc(var(--space-xs) + env(safe-area-inset-bottom));
			padding-inline: var(--space-2xs);
			position: fixed;
			text-align: start;
			top: 0;
		}

		.nav-item__link.expanded + .nav-submenu,
		.nav-item__link.expanded + * > .nav-submenu {
			display: none;
		}

		.nav-submenu-item__link {
			padding: var(--space-2xs);
		}

		@screen lg {

			.nav-item__link.expanded + .nav-submenu,
			.nav-item__link.expanded + * > .nav-submenu {
				display: block;
			}
		}
	}
}